{"ast":null,"code":"var _jsxFileName = \"/home/shaon/Projects/auth/auth-client/src/components/Login.js\";\nimport React from 'react';\nimport { Redirect } from 'react-router-dom';\nimport apiClient, { api_url, client_url, login_url, csrf_token_url } from '../services/api';\nimport Cookies from 'js-cookie';\nconst Login = props => {\n  const [email, setEmail] = React.useState('');\n  const [password, setPassword] = React.useState('');\n  const [toHome, setToHome] = React.useState(false);\n  const [authError, setAuthError] = React.useState(false);\n  const [unknownError, setUnknownError] = React.useState(false);\n  const handleSubmit = e => {\n    e.preventDefault();\n    setAuthError(false);\n    setUnknownError(false);\n    apiClient.get(csrf_token_url).then(response => {\n      apiClient.post(login_url, {\n        email: email,\n        password: password\n      }).then(response => {\n        console.log(response.data.access_token);\n        if (response.status === 200) {\n          //204\n          Cookies.set('access_token', response.data.data.access_token);\n          props.login();\n          setToHome(true);\n        }\n      }).catch(error => {\n        if (error.response && error.response.status === 422) {\n          setAuthError(true);\n        } else {\n          setUnknownError(true);\n          console.error(error);\n        }\n      });\n    });\n  };\n  if (toHome === true) {\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 16\n      }\n    });\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 13\n    }\n  }, \"Login\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    className: \"form-control\" + (authError || unknownError ? ' is-invalid' : ''),\n    placeholder: \"Email\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    className: \"form-control\" + (authError || unknownError ? ' is-invalid' : ''),\n    placeholder: \"Password\",\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 21\n    }\n  })), authError ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 30\n    }\n  }, \"Credentials not recognised. Please try again.\") : null, unknownError ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 33\n    }\n  }, \"There was an error submitting your details.\") : null, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 17\n    }\n  }, \"Login\")));\n};\nexport default Login;","map":{"version":3,"names":["React","Redirect","apiClient","api_url","client_url","login_url","csrf_token_url","Cookies","Login","props","email","setEmail","useState","password","setPassword","toHome","setToHome","authError","setAuthError","unknownError","setUnknownError","handleSubmit","e","preventDefault","get","then","response","post","console","log","data","access_token","status","set","login","catch","error","target","value"],"sources":["/home/shaon/Projects/auth/auth-client/src/components/Login.js"],"sourcesContent":["import React from 'react';\nimport { Redirect } from 'react-router-dom';\nimport apiClient,{api_url,client_url,login_url,csrf_token_url } from '../services/api';\nimport Cookies from 'js-cookie';\n\nconst Login = (props) => {\n    const [email, setEmail] = React.useState('');\n    const [password, setPassword] = React.useState('');\n    const [toHome, setToHome] = React.useState(false);\n    const [authError, setAuthError] = React.useState(false);\n    const [unknownError, setUnknownError] = React.useState(false);\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        setAuthError(false);\n        setUnknownError(false);\n        apiClient.get(csrf_token_url)\n        .then(response => {\n            apiClient.post(login_url, {\n                email: email,\n                password: password\n            }).then(response => {\n                console.log(response.data.access_token)\n                if (response.status === 200) { //204\n                    Cookies.set('access_token',response.data.data.access_token)\n                    props.login();\n                    setToHome(true);\n                }\n            }).catch(error => {\n                if (error.response && error.response.status === 422) {\n                    setAuthError(true);\n                } else {\n                    setUnknownError(true);\n                    console.error(error);\n                }\n            });\n        });\n    }\n    if (toHome === true) {\n        return <Redirect to='/' />\n    }\n    return (\n        <div>\n            <h3>Login</h3>\n            <form onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                    <input\n                        type=\"email\"\n                        name=\"email\"\n                        className={\"form-control\" + (authError || unknownError ? ' is-invalid' : '')}\n                        placeholder=\"Email\"\n                        value={email}\n                        onChange={e => setEmail(e.target.value)}\n                        required\n                    />\n                </div>\n                <div className=\"form-group\">\n                    <input\n                        type=\"password\"\n                        name=\"password\"\n                        className={\"form-control\" + (authError || unknownError ? ' is-invalid' : '')}\n                        placeholder=\"Password\"\n                        value={password}\n                        onChange={e => setPassword(e.target.value)}\n                        required\n                    />\n                </div>\n                {authError ? <div className=\"alert alert-danger\">Credentials not recognised. Please try again.</div> : null}\n                {unknownError ? <div className=\"alert alert-danger\">There was an error submitting your details.</div> : null}\n                <button type=\"submit\" className=\"btn btn-primary\">Login</button>  \n            </form>\n        </div>\n    );\n};\n\nexport default Login;"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,OAAOC,SAAS,IAAEC,OAAO,EAACC,UAAU,EAACC,SAAS,EAACC,cAAc,QAAQ,iBAAiB;AACtF,OAAOC,OAAO,MAAM,WAAW;AAE/B,MAAMC,KAAK,GAAIC,KAAK,IAAK;EACrB,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGX,KAAK,CAACY,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGd,KAAK,CAACY,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACG,MAAM,EAAEC,SAAS,CAAC,GAAGhB,KAAK,CAACY,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACK,SAAS,EAAEC,YAAY,CAAC,GAAGlB,KAAK,CAACY,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAACO,YAAY,EAAEC,eAAe,CAAC,GAAGpB,KAAK,CAACY,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAMS,YAAY,GAAIC,CAAC,IAAK;IACxBA,CAAC,CAACC,cAAc,EAAE;IAClBL,YAAY,CAAC,KAAK,CAAC;IACnBE,eAAe,CAAC,KAAK,CAAC;IACtBlB,SAAS,CAACsB,GAAG,CAAClB,cAAc,CAAC,CAC5BmB,IAAI,CAACC,QAAQ,IAAI;MACdxB,SAAS,CAACyB,IAAI,CAACtB,SAAS,EAAE;QACtBK,KAAK,EAAEA,KAAK;QACZG,QAAQ,EAAEA;MACd,CAAC,CAAC,CAACY,IAAI,CAACC,QAAQ,IAAI;QAChBE,OAAO,CAACC,GAAG,CAACH,QAAQ,CAACI,IAAI,CAACC,YAAY,CAAC;QACvC,IAAIL,QAAQ,CAACM,MAAM,KAAK,GAAG,EAAE;UAAE;UAC3BzB,OAAO,CAAC0B,GAAG,CAAC,cAAc,EAACP,QAAQ,CAACI,IAAI,CAACA,IAAI,CAACC,YAAY,CAAC;UAC3DtB,KAAK,CAACyB,KAAK,EAAE;UACblB,SAAS,CAAC,IAAI,CAAC;QACnB;MACJ,CAAC,CAAC,CAACmB,KAAK,CAACC,KAAK,IAAI;QACd,IAAIA,KAAK,CAACV,QAAQ,IAAIU,KAAK,CAACV,QAAQ,CAACM,MAAM,KAAK,GAAG,EAAE;UACjDd,YAAY,CAAC,IAAI,CAAC;QACtB,CAAC,MAAM;UACHE,eAAe,CAAC,IAAI,CAAC;UACrBQ,OAAO,CAACQ,KAAK,CAACA,KAAK,CAAC;QACxB;MACJ,CAAC,CAAC;IACN,CAAC,CAAC;EACN,CAAC;EACD,IAAIrB,MAAM,KAAK,IAAI,EAAE;IACjB,oBAAO,oBAAC,QAAQ;MAAC,EAAE,EAAC,GAAG;MAAA;MAAA;QAAA;QAAA;QAAA;MAAA;IAAA,EAAG;EAC9B;EACA,oBACI;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,gBACI;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,WAAc,eACd;IAAM,QAAQ,EAAEM,YAAa;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,gBACzB;IAAK,SAAS,EAAC,YAAY;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,gBACvB;IACI,IAAI,EAAC,OAAO;IACZ,IAAI,EAAC,OAAO;IACZ,SAAS,EAAE,cAAc,IAAIJ,SAAS,IAAIE,YAAY,GAAG,aAAa,GAAG,EAAE,CAAE;IAC7E,WAAW,EAAC,OAAO;IACnB,KAAK,EAAET,KAAM;IACb,QAAQ,EAAEY,CAAC,IAAIX,QAAQ,CAACW,CAAC,CAACe,MAAM,CAACC,KAAK,CAAE;IACxC,QAAQ;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EACV,CACA,eACN;IAAK,SAAS,EAAC,YAAY;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,gBACvB;IACI,IAAI,EAAC,UAAU;IACf,IAAI,EAAC,UAAU;IACf,SAAS,EAAE,cAAc,IAAIrB,SAAS,IAAIE,YAAY,GAAG,aAAa,GAAG,EAAE,CAAE;IAC7E,WAAW,EAAC,UAAU;IACtB,KAAK,EAAEN,QAAS;IAChB,QAAQ,EAAES,CAAC,IAAIR,WAAW,CAACQ,CAAC,CAACe,MAAM,CAACC,KAAK,CAAE;IAC3C,QAAQ;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EACV,CACA,EACLrB,SAAS,gBAAG;IAAK,SAAS,EAAC,oBAAoB;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,mDAAoD,GAAG,IAAI,EAC1GE,YAAY,gBAAG;IAAK,SAAS,EAAC,oBAAoB;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,iDAAkD,GAAG,IAAI,eAC5G;IAAQ,IAAI,EAAC,QAAQ;IAAC,SAAS,EAAC,iBAAiB;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,WAAe,CAC7D,CACL;AAEd,CAAC;AAED,eAAeX,KAAK"},"metadata":{},"sourceType":"module"}